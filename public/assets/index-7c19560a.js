import{_ as w,N as W}from"./index.vue_vue_type_script_setup_true_lang-9ac1b05a.js";import{J as U,H as b,Q as K,ap as R,d as N,L as Y,O as F,b$ as q,c as g,bc as Q,bi as X,_ as Z,c0 as ee,G as v,bO as se,a3 as te,a as ne,aI as M,u as ae,b as oe,r as C,m as I,e as P,h as e,t as p,f as i,g as s,p as V,w as u,v as $,q as k,n as ie,F as le,i as re,bo as ce,aD as D,o as de,x as J,aF as pe,aG as ue}from"./index-2a868905.js";import{b as fe}from"./Select-3febf034.js";import{b as me,N as j}from"./Tabs-2e12da33.js";const he=U([U("@keyframes spin-rotate",`
 from {
 transform: rotate(0);
 }
 to {
 transform: rotate(360deg);
 }
 `),b("spin-container",{position:"relative"},[b("spin-body",`
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[K()])]),b("spin-body",`
 display: inline-flex;
 align-items: center;
 justify-content: center;
 flex-direction: column;
 `),b("spin",`
 display: inline-flex;
 height: var(--n-size);
 width: var(--n-size);
 font-size: var(--n-size);
 color: var(--n-color);
 `,[R("rotate",`
 animation: spin-rotate 2s linear infinite;
 `)]),b("spin-description",`
 display: inline-block;
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 margin-top: 8px;
 `),b("spin-content",`
 opacity: 1;
 transition: opacity .3s var(--n-bezier);
 pointer-events: all;
 `,[R("spinning",`
 user-select: none;
 -webkit-user-select: none;
 pointer-events: none;
 opacity: var(--n-opacity-spinning);
 `)])]),ve={small:20,medium:18,large:16},_e=Object.assign(Object.assign({},F.props),{description:String,stroke:String,size:{type:[String,Number],default:"medium"},show:{type:Boolean,default:!0},strokeWidth:Number,rotate:{type:Boolean,default:!0},spinning:{type:Boolean,validator:()=>!0,default:void 0}}),ge=N({name:"Spin",props:_e,setup(l){const{mergedClsPrefixRef:c,inlineThemeDisabled:t}=Y(l),n=F("Spin","-spin",he,q,l,c),d=g(()=>{const{size:a}=l,{common:{cubicBezierEaseInOut:h},self:x}=n.value,{opacitySpinning:_,color:B,textColor:T}=x,O=typeof a=="number"?Q(a):x[X("size",a)];return{"--n-bezier":h,"--n-opacity-spinning":_,"--n-size":O,"--n-color":B,"--n-text-color":T}}),f=t?Z("spin",g(()=>{const{size:a}=l;return typeof a=="number"?String(a):a[0]}),d,l):void 0;return{mergedClsPrefix:c,compitableShow:ee(l,["spinning","show"]),mergedStrokeWidth:g(()=>{const{strokeWidth:a}=l;if(a!==void 0)return a;const{size:h}=l;return ve[typeof h=="number"?"medium":h]}),cssVars:t?void 0:d,themeClass:f==null?void 0:f.themeClass,onRender:f==null?void 0:f.onRender}},render(){var l,c;const{$slots:t,mergedClsPrefix:n,description:d}=this,f=t.icon&&this.rotate,a=(d||t.description)&&v("div",{class:`${n}-spin-description`},d||((l=t.description)===null||l===void 0?void 0:l.call(t))),h=t.icon?v("div",{class:[`${n}-spin-body`,this.themeClass]},v("div",{class:[`${n}-spin`,f&&`${n}-spin--rotate`],style:t.default?"":this.cssVars},t.icon()),a):v("div",{class:[`${n}-spin-body`,this.themeClass]},v(se,{clsPrefix:n,style:t.default?"":this.cssVars,stroke:this.stroke,"stroke-width":this.mergedStrokeWidth,class:`${n}-spin`}),a);return(c=this.onRender)===null||c===void 0||c.call(this),t.default?v("div",{class:[`${n}-spin-container`,this.themeClass],style:this.cssVars},v("div",{class:[`${n}-spin-content`,this.compitableShow&&`${n}-spin-content--spinning`]},t),v(te,{name:"fade-in-transition"},{default:()=>this.compitableShow?h:null})):h}});function xe(){const l=new Date,c=l.getDate(),t=l.getMonth()+1;return`${l.getFullYear()}-${t}-${c}`}const ye={class:"p-4 space-y-5 min-h-[200px]"},be={class:"space-y-6"},$e={class:"flex items-center space-x-4"},ke={class:"flex-shrink-0 w-[100px]"},we={class:"flex-1"},Se={class:"flex items-center space-x-4"},Ce={class:"flex-shrink-0 w-[100px]"},ze={class:"w-[200px]"},Ie={class:"flex-shrink-0 w-[100px]"},Ne={class:"flex flex-wrap items-center gap-4"},Be={class:"flex items-center space-x-4"},Te={class:"flex-shrink-0 w-[100px]"},Oe={class:"flex flex-wrap items-center gap-4"},De={class:"flex items-center space-x-4"},Le={class:"flex-shrink-0 w-[100px]"},Ue={class:"flex flex-wrap items-center gap-4"},Re=N({__name:"General",setup(l){const c=ne(),t=M(),{isMobile:n}=ae(),d=oe(),f=g(()=>c.theme),a=g(()=>t.userInfo),h=C(a.value.avatar??""),x=C(a.value.username??""),_=C(!1),B=g({get(){return c.language},set(o){c.setLanguage(o)}}),T=[{label:"Auto",key:"auto",icon:"ri:contrast-line"},{label:"Light",key:"light",icon:"ri:sun-foggy-line"},{label:"Dark",key:"dark",icon:"ri:moon-foggy-line"}],O=[{label:"简体中文",key:"zh-CN",value:"zh-CN"}];async function L(o){try{_.value=!0;const r=await ce(o);if(_.value=!1,!r.success)return d.error(r.message);d.success(D("common.updateUserSuccess")),t.getUserInfo()}catch{_.value=!1}}function A(){const o=xe(),r=localStorage.getItem("chatStorage")||"{}",m=JSON.stringify(JSON.parse(r),null,2),y=new Blob([m],{type:"application/json"}),z=URL.createObjectURL(y),S=document.createElement("a");S.href=z,S.download=`chat-store_${o}.json`,document.body.appendChild(S),S.click(),document.body.removeChild(S)}function E(o){const r=o.target;if(!r||!r.files)return;const m=r.files[0];if(!m)return;const y=new FileReader;y.onload=()=>{try{const z=JSON.parse(y.result);localStorage.setItem("chatStorage",JSON.stringify(z)),d.success(D("common.success")),location.reload()}catch{d.error(D("common.invalidFileFormat"))}},y.readAsText(m)}function G(){localStorage.removeItem("chatStorage"),location.reload()}function H(){const o=document.getElementById("fileInput");o&&o.click()}return(o,r)=>(I(),P("div",ye,[e("div",be,[e("div",$e,[e("span",ke,p(o.$t("setting.avatarLink")),1),e("div",we,[i(s(V),{value:h.value,"onUpdate:value":r[0]||(r[0]=m=>h.value=m),placeholder:"请填写头像地址"},null,8,["value"])]),i(s(k),{size:"tiny",disabled:_.value,text:"",type:"primary",onClick:r[1]||(r[1]=m=>L({avatar:h.value}))},{default:u(()=>[$(p(o.$t("common.update")),1)]),_:1},8,["disabled"])]),e("div",Se,[e("span",Ce,p(o.$t("setting.name")),1),e("div",ze,[i(s(V),{value:x.value,"onUpdate:value":r[2]||(r[2]=m=>x.value=m),placeholder:"请填写用户名"},null,8,["value"])]),i(s(k),{size:"tiny",disabled:_.value,text:"",type:"primary",onClick:r[3]||(r[3]=m=>L({username:x.value}))},{default:u(()=>[$(p(o.$t("common.update")),1)]),_:1},8,["disabled"])]),e("div",{class:ie(["flex items-center space-x-4",s(n)&&"items-start"])},[e("span",Ie,p(o.$t("setting.chatHistory")),1),e("div",Ne,[i(s(k),{size:"small",onClick:A},{icon:u(()=>[i(s(w),{icon:"ri:download-2-fill"})]),default:u(()=>[$(" "+p(o.$t("common.export")),1)]),_:1}),e("input",{id:"fileInput",type:"file",style:{display:"none"},onChange:E},null,32),i(s(k),{size:"small",onClick:H},{icon:u(()=>[i(s(w),{icon:"ri:upload-2-fill"})]),default:u(()=>[$(" "+p(o.$t("common.import")),1)]),_:1}),i(s(W),{placement:"bottom",onPositiveClick:G},{trigger:u(()=>[i(s(k),{size:"small"},{icon:u(()=>[i(s(w),{icon:"ri:close-circle-line"})]),default:u(()=>[$(" "+p(o.$t("common.clear")),1)]),_:1})]),default:u(()=>[$(" "+p(o.$t("chat.clearHistoryConfirm")),1)]),_:1})])],2),e("div",Be,[e("span",Te,p(o.$t("setting.theme")),1),e("div",Oe,[(I(),P(le,null,re(T,m=>i(s(k),{key:m.key,size:"small",type:m.key===s(f)?"primary":void 0,onClick:y=>s(c).setTheme(m.key)},{icon:u(()=>[i(s(w),{icon:m.icon},null,8,["icon"])]),_:2},1032,["type","onClick"])),64))])]),e("div",De,[e("span",Le,p(o.$t("setting.language")),1),e("div",Ue,[i(s(fe),{style:{width:"140px"},value:s(B),options:O,onUpdateValue:r[4]||(r[4]=m=>s(c).setLanguage(m))},null,8,["value"])])])])]))}}),Pe={class:"p-4 space-y-5 min-h-[200px]"},Ve={class:"flex items-center space-x-4"},je=e("span",{class:"flex-shrink-0 w-[100px]"},"用户邮箱",-1),Fe={class:"w-[200px]"},Me={class:"flex items-center space-x-4"},Je=e("span",{class:"flex-shrink-0 w-[100px]"},"用户姓名",-1),Ae={class:"w-[200px]"},Ee={class:"flex items-center space-x-4"},Ge=e("span",{class:"flex-shrink-0 w-[100px]"},"问答余额",-1),He={class:"w-[200px]"},We={class:"flex items-center space-x-4"},Ke=e("span",{class:"flex-shrink-0 w-[100px]"},"绘画余额",-1),Ye={class:"w-[200px]"},qe={class:"flex items-center space-x-4"},Qe=e("span",{class:"flex-shrink-0 w-[100px]"},"MJ余额",-1),Xe={class:"w-[200px]"},Ze={class:"flex items-center space-x-4"},es=e("span",{class:"flex-shrink-0 w-[100px]"},"使用金额",-1),ss={class:"w-[200px]"},ts=N({__name:"Personal",setup(l){const c=M(),{userInfo:t,userBalance:n}=c,d=C(!1);de(async()=>{f()});async function f(){try{d.value=!0,await c.getUserInfo(),d.value=!1}catch{d.value=!1}}return(a,h)=>(I(),J(s(ge),{show:d.value},{default:u(()=>[e("div",Pe,[e("div",Ve,[je,e("div",Fe,p(s(t).email||"--"),1)]),e("div",Me,[Je,e("div",Ae,p(s(t).username||"--"),1)]),e("div",Ee,[Ge,e("div",He,p(s(n).usesLeft||"0")+"次 ",1)]),e("div",We,[Ke,e("div",Ye,p(s(n).paintCount||"0")+"次 ",1)]),e("div",qe,[Qe,e("div",Xe,p(s(n).balance||"0")+" 次 ",1)]),e("div",Ze,[es,e("div",ss,p(s(n).useTokens||"0")+" Token ",1)])])]),_:1},8,["show"]))}}),ns={class:"ml-2"},as={class:"ml-2"},os={class:"min-h-[100px]"},ds=N({__name:"index",props:{visible:{type:Boolean}},emits:["update:visible"],setup(l,{emit:c}){const t=l,n=C("personalInfo"),d=g({get(){return t.visible},set(f){c("update:visible",f)}});return(f,a)=>(I(),J(s(ue),{show:s(d),"onUpdate:show":a[1]||(a[1]=h=>pe(d)?d.value=h:null),title:"个人中心","auto-focus":!1,preset:"card",style:{width:"95%","max-width":"640px"}},{default:u(()=>[e("div",null,[i(s(me),{value:n.value,"onUpdate:value":a[0]||(a[0]=h=>n.value=h),type:"line",animated:""},{default:u(()=>[i(s(j),{name:"personalInfo",tab:"personalInfo"},{tab:u(()=>[i(s(w),{class:"text-lg",icon:"ri:file-user-line"}),e("span",ns,p(f.$t("setting.personalInfo")),1)]),default:u(()=>[i(ts)]),_:1}),i(s(j),{name:"General",tab:"General"},{tab:u(()=>[i(s(w),{class:"text-lg",icon:"ri:list-settings-line"}),e("span",as,p(f.$t("setting.general")),1)]),default:u(()=>[e("div",os,[i(Re)])]),_:1})]),_:1},8,["value"])])]),_:1},8,["show"]))}});export{ds as default};
