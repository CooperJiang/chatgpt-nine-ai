
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as ne}from"./index-56b33bff.js";import{A as V}from"./package-d4e90f70.js";import{P as ue,I as B,e as S}from"./index-68385382.js";import{d as de,r as g,Q as I,B as N,x as se,o as w,c as T,e,f as t,N as ie,R as pe,b as f,k as p,w as me,I as x,t as C,S as fe,a as ce,J as $,E as P,W as _e,h as n,X as ge,q as Y}from"./index-be23d7e6.js";const be={class:"flex justify-end mr-5"},ve=de({__name:"package",setup(we){const M=g(),R=g(0),b=g(!1),y=g(!1),m=I({name:"",page:1,size:10}),k=g(),v=g(0),o=I({name:"",des:"",coverImg:"",price:5,order:100,status:0,days:7,balance:0,usesLeft:0,paintCount:0,extraReward:0,extraBalance:0,extraUsesLeft:0,extraPaintCount:0}),O=I({name:[{required:!0,message:"请填写套餐名称",trigger:"blur"}],des:[{required:!0,message:"请填写套餐描述",trigger:"blur"}],coverImg:[{required:!1,message:"请填写封面图地址",trigger:"blur"}],price:[{required:!0,message:"请填写套餐价格",trigger:"blur"}],order:[{required:!1,message:"请填写排序ID",trigger:"blur"}],status:[{required:!0,message:"请选择套餐状态",trigger:"change"}],days:[{required:!0,message:"请填写卡密有效期天数",trigger:"blur"}],balance:[{required:!0,message:"请填写卡密携带金额",trigger:"blur"}],usesLeft:[{required:!0,message:"请填写卡密携带对话次数",trigger:"blur"}],paintCount:[{required:!0,message:"请填写卡密携带绘画次数",trigger:"blur"}],extraReward:[{required:!0,message:"请确认是否开启额外赠送",trigger:"change"}]}),q=g([]);async function c(){try{y.value=!0;const r=await V.queryAllPackage(m);y.value=!1;const{rows:a,count:U}=r.data;R.value=U,q.value=a}catch{y.value=!1}}function j(r){r==null||r.resetFields(),c()}async function F({id:r}){await V.delPackage({id:r}),P({type:"success",message:"删除套餐成功！"}),c()}function J(r){v.value=r.id,_e(()=>{Object.assign(o,r),o==null||delete o.createdAt,o==null||delete o.updatedAt,o==null||delete o.deletedAt,o==null||delete o.id}),b.value=!0}const G=N(()=>v.value?"更新套餐":"新增套餐"),K=N(()=>v.value?"确认更新":"确认新增");function Q(r){v.value=0,r==null||r.resetFields()}async function W(r){r==null||r.validate(async a=>{a&&(v.value?(await V.updatePackage({id:v.value,...o}),P({type:"success",message:"更新套餐成功！"})):(await V.createPackage(o),P({type:"success",message:"创建新的套餐成功！"})),b.value=!1,c())})}return se(()=>{c()}),(r,a)=>{const U=n("el-option"),X=n("el-select"),u=n("el-form-item"),_=n("el-button"),H=n("Plus"),Z=n("el-icon"),h=n("el-form"),L=ne,d=n("el-table-column"),E=n("el-image"),z=n("el-tag"),ee=n("el-popconfirm"),le=n("el-table"),te=n("el-pagination"),A=n("el-row"),s=n("el-input"),i=n("el-col"),D=n("el-switch"),ae=n("el-dialog"),oe=ge("loading");return w(),T("div",null,[e(L,null,{default:t(()=>[e(h,{ref_key:"formRef",ref:M,inline:!0,model:m},{default:t(()=>[e(u,{label:"套餐状态",prop:"status"},{default:t(()=>[e(X,{modelValue:m.status,"onUpdate:modelValue":a[0]||(a[0]=l=>m.status=l),placeholder:"请选择套餐状态",clearable:""},{default:t(()=>[(w(!0),T(ie,null,pe(f(ue),l=>(w(),x(U,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,null,{default:t(()=>[e(_,{type:"primary",onClick:c},{default:t(()=>[p(" 查询 ")]),_:1}),e(_,{onClick:a[1]||(a[1]=l=>j(M.value))},{default:t(()=>[p(" 重置 ")]),_:1})]),_:1}),e(_,{type:"success",style:{float:"right"},onClick:a[2]||(a[2]=l=>b.value=!0)},{default:t(()=>[p(" 创建套餐 "),e(Z,{class:"ml-3"},{default:t(()=>[e(H)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(L,{style:{width:"100%"}},{default:t(()=>[me((w(),x(le,{border:"",data:q.value,style:{width:"100%"},size:"large"},{default:t(()=>[e(d,{fixed:"",prop:"name",label:"套餐名称",width:"150"}),e(d,{prop:"order",label:"排序ID",width:"120"}),e(d,{prop:"coverImg",label:"套餐封面",width:"200"},{default:t(l=>[e(E,{style:{height:"50px"},src:l.row.coverImg,fit:"fill"},null,8,["src"])]),_:1}),e(d,{prop:"status",label:"套餐状态",width:"120"},{default:t(l=>[e(z,{type:f(B)[l.row.status]},{default:t(()=>[p(C(f(S)[l.row.status]),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"des",label:"套餐描述",width:"300"}),e(d,{prop:"price",label:"套餐价格",width:"200"}),e(d,{prop:"days",label:"生成有效期",width:"120"}),e(d,{prop:"balance",label:"携带余额",width:"120"}),e(d,{prop:"usesLeft",label:"携带对话次数",width:"120"}),e(d,{prop:"paintCount",label:"携带绘画次数",width:"120"}),e(d,{prop:"extraReward",label:"开启额外赠送",width:"120"},{default:t(l=>[e(z,{type:f(B)[l.row.extraReward]},{default:t(()=>[p(C(f(S)[l.row.extraReward]),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"extraBalance",label:"额外携带余额",width:"120"}),e(d,{prop:"extraUsesLeft",label:"额外对话次数",width:"120"}),e(d,{prop:"extraPaintCount",label:"额外绘画次数",width:"120"}),e(d,{prop:"createdAt",label:"创建时间",width:"200"},{default:t(l=>[p(C(f(fe)(new Date(l.row.createdAt),"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),e(d,{fixed:"right",label:"操作",width:"200"},{default:t(l=>[e(_,{link:"",type:"primary",size:"small",onClick:re=>J(l.row)},{default:t(()=>[p(" 修改套餐 ")]),_:2},1032,["onClick"]),e(ee,{title:"确认删除此套餐么?",width:"200","icon-color":"red",onConfirm:re=>F(l.row)},{reference:t(()=>[e(_,{link:"",type:"danger",size:"small"},{default:t(()=>[p(" 删除套餐 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[oe,y.value]]),e(A,{class:"flex justify-end mt-5"},{default:t(()=>[e(te,{"current-page":m.page,"onUpdate:currentPage":a[3]||(a[3]=l=>m.page=l),"page-size":m.size,"onUpdate:pageSize":a[4]||(a[4]=l=>m.size=l),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:R.value,onSizeChange:c,onCurrentChange:c},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),e(ae,{modelValue:b.value,"onUpdate:modelValue":a[21]||(a[21]=l=>b.value=l),"close-on-click-modal":!1,title:f(G),width:"870",onClose:a[22]||(a[22]=l=>Q(k.value))},{footer:t(()=>[ce("span",be,[e(_,{onClick:a[19]||(a[19]=l=>b.value=!1)},{default:t(()=>[p("取消")]),_:1}),e(_,{type:"primary",onClick:a[20]||(a[20]=l=>W(k.value))},{default:t(()=>[p(C(f(K)),1)]),_:1})])]),default:t(()=>[e(h,{ref_key:"formPackageRef",ref:k,"label-position":"right","label-width":"100px",model:o,rules:O},{default:t(()=>[e(A,null,{default:t(()=>[e(i,{span:11},{default:t(()=>[e(u,{label:"套餐名称",prop:"name"},{default:t(()=>[e(s,{modelValue:o.name,"onUpdate:modelValue":a[5]||(a[5]=l=>o.name=l),placeholder:"请填写套餐名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:11,offset:2},{default:t(()=>[e(u,{label:"套餐状态",prop:"status"},{default:t(()=>[e(D,{modelValue:o.status,"onUpdate:modelValue":a[6]||(a[6]=l=>o.status=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:11},{default:t(()=>[e(u,{label:"套餐描述",prop:"des"},{default:t(()=>[e(s,{modelValue:o.des,"onUpdate:modelValue":a[7]||(a[7]=l=>o.des=l),type:"textarea",placeholder:"请填写套餐介绍信息、用于对外展示...",rows:6},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:11,offset:2},{default:t(()=>[e(u,{label:"对话次数",prop:"usesLeft"},{default:t(()=>[e(s,{modelValue:o.usesLeft,"onUpdate:modelValue":a[8]||(a[8]=l=>o.usesLeft=l),modelModifiers:{number:!0},type:"number",placeholder:"卡密携带对话次数"},null,8,["modelValue"])]),_:1}),e(u,{label:"绘画次数",prop:"paintCount"},{default:t(()=>[e(s,{modelValue:o.paintCount,"onUpdate:modelValue":a[9]||(a[9]=l=>o.paintCount=l),modelModifiers:{number:!0},type:"number",placeholder:"卡密携带绘画次数"},null,8,["modelValue"])]),_:1}),e(u,{label:"MJ次数",prop:"balance"},{default:t(()=>[e(s,{modelValue:o.balance,"onUpdate:modelValue":a[10]||(a[10]=l=>o.balance=l),modelModifiers:{number:!0},type:"number",placeholder:"卡密携带MJ金额"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:11},{default:t(()=>[e(u,{label:"套餐价格",prop:"price"},{default:t(()=>[e(s,{modelValue:o.price,"onUpdate:modelValue":a[11]||(a[11]=l=>o.price=l),modelModifiers:{number:!0},placeholder:"请填写套餐价格(￥)整数",type:"number"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:11,offset:2},{default:t(()=>[e(u,{label:"有效日期",prop:"days"},{default:t(()=>[e(s,{modelValue:o.days,"onUpdate:modelValue":a[12]||(a[12]=l=>o.days=l),modelModifiers:{number:!0},type:"number",placeholder:"自卡密生成之日有效天数、不填为永久"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:11},{default:t(()=>[e(u,{label:"套餐封面",prop:"coverImg"},{default:t(()=>[e(s,{modelValue:o.coverImg,"onUpdate:modelValue":a[13]||(a[13]=l=>o.coverImg=l),placeholder:"请填写套餐封面地址"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:11,offset:2},{default:t(()=>[e(u,{label:"套餐排序",prop:"order"},{default:t(()=>[e(s,{modelValue:o.order,"onUpdate:modelValue":a[14]||(a[14]=l=>o.order=l),modelModifiers:{number:!0},type:"number",placeholder:"排序Id越大越靠前"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:11},{default:t(()=>[e(u,{label:"开启赠送",prop:"extraReward"},{default:t(()=>[e(D,{modelValue:o.extraReward,"onUpdate:modelValue":a[15]||(a[15]=l=>o.extraReward=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:11,offset:2},{default:t(()=>[e(u,{label:"额外金额",prop:"extraBalance"},{default:t(()=>[e(s,{modelValue:o.extraBalance,"onUpdate:modelValue":a[16]||(a[16]=l=>o.extraBalance=l),modelModifiers:{number:!0},type:"number",placeholder:"卡密赠送金额"},null,8,["modelValue"])]),_:1})]),_:1}),o.extraReward?(w(),x(i,{key:0,span:11},{default:t(()=>[e(u,{label:"额外绘画",prop:"extraPaintCount"},{default:t(()=>[e(s,{modelValue:o.extraPaintCount,"onUpdate:modelValue":a[17]||(a[17]=l=>o.extraPaintCount=l),modelModifiers:{number:!0},type:"number",placeholder:"卡密赠送绘画次数"},null,8,["modelValue"])]),_:1})]),_:1})):$("",!0),o.extraReward?(w(),x(i,{key:1,span:11,offset:2,placeholder:""},{default:t(()=>[e(u,{label:"额外对话",prop:"extraUsesLeft"},{default:t(()=>[e(s,{modelValue:o.extraUsesLeft,"onUpdate:modelValue":a[18]||(a[18]=l=>o.extraUsesLeft=l),modelModifiers:{number:!0},type:"number",placeholder:"卡密赠送对话次数"},null,8,["modelValue"])]),_:1})]),_:1})):$("",!0)]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});typeof Y=="function"&&Y(ve);export{ve as default};
