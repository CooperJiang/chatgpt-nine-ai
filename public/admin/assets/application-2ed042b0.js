
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as re}from"./index-56b33bff.js";import{d as ue,r as f,Q as x,B as R,x as pe,o as _,c as C,e as l,f as a,N as z,R as q,b as r,j as de,k as i,w as ie,I as U,t as S,S as me,a as ce,U as fe,V as I,W as _e,E as P,h as s,X as ge,l as ve,q as $}from"./index-be23d7e6.js";import{E as be,Q as we}from"./index-68385382.js";const ye={class:"flex justify-end mr-5"},Ve=ue({__name:"application",setup(Ae){const T=f(),N=f(0),g=f(!1),k=f(!1),p=x({catId:"",name:"",status:"",page:1,size:10}),D=f(),b=f(0),n=x({catId:"",name:"",preset:"",des:"",coverImg:"",order:100,status:0}),j=x({catId:[{required:!0,message:"请选择App分类",trigger:"change"}],name:[{required:!0,message:"请填写App名称",trigger:"blur"}],preset:[{required:!0,message:"请填写App预设信息",trigger:"blur"}],des:[{required:!0,message:"请填写App描述",trigger:"blur"}],coverImg:[{required:!1,message:"请填写App封面图片地址",trigger:"blur"}],order:[{required:!1,message:"请填写排序ID",trigger:"blur"}],status:[{required:!0,message:"请选择App状态",trigger:"change"}]}),B=f([]),h=f([]),L=R(()=>b.value?"更新套餐":"新增套餐"),O=R(()=>b.value?"确认更新":"确认新增");async function m(){try{k.value=!0;const o=await I.queryApp(p),{rows:t,count:w}=o.data;k.value=!1,N.value=w,B.value=t}catch{k.value=!1}}async function Y(){const o=await I.queryCats({size:100}),{rows:t}=o.data;h.value=t}function F(o){b.value=o.id;const{name:t,status:w,des:y,order:V,coverImg:A,catId:u,preset:c}=o;_e(()=>{Object.assign(n,{name:t,status:w,des:y,order:V,coverImg:A,catId:u,preset:c})}),g.value=!0}function K(o){b.value=0,o==null||o.resetFields()}async function Q(o){await I.deleteApp({id:o.id}),P.success("删除分类成功"),m()}function W(o){o==null||o.resetFields(),m()}function X(o){o==null||o.validate(async t=>{t&&(b.value?(await I.updateApp({id:b.value,...n}),P({type:"success",message:"更新套餐成功！"})):(await I.createApp(n),P({type:"success",message:"创建新的套餐成功！"})),g.value=!1,m())})}return pe(()=>{m(),Y()}),(o,t)=>{const w=s("el-alert"),y=re,V=s("el-option"),A=s("el-select"),u=s("el-form-item"),c=s("el-input"),v=s("el-button"),G=s("Plus"),H=s("el-icon"),M=s("el-form"),J=s("el-image"),d=s("el-table-column"),Z=s("el-tag"),E=s("el-popconfirm"),ee=s("el-table"),le=s("el-pagination"),te=s("el-row"),ae=s("el-switch"),oe=s("el-dialog"),ne=ge("loading");return _(),C("div",null,[l(y,null,{default:a(()=>[l(w,{closable:!1,"show-icon":"",title:"应用分类说明",description:"当前版本应用分类管理暂未对用户端接入、待用户端接入中。",type:"warning"})]),_:1}),l(y,null,{default:a(()=>[l(M,{ref_key:"formRef",ref:T,inline:!0,model:p},{default:a(()=>[l(u,{label:"App分类",prop:"catId"},{default:a(()=>[l(A,{modelValue:p.catId,"onUpdate:modelValue":t[0]||(t[0]=e=>p.catId=e),placeholder:"请选择App分类",clearable:""},{default:a(()=>[(_(!0),C(z,null,q(r(h),e=>(_(),U(V,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"App状态",prop:"status"},{default:a(()=>[l(A,{modelValue:p.status,"onUpdate:modelValue":t[1]||(t[1]=e=>p.status=e),placeholder:"请选择App状态",clearable:""},{default:a(()=>[(_(!0),C(z,null,q(r(be),e=>(_(),U(V,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"App名称",prop:"name"},{default:a(()=>[l(c,{modelValue:p.name,"onUpdate:modelValue":t[2]||(t[2]=e=>p.name=e),placeholder:"App名称[模糊搜索]",clearable:"",onKeydown:de(ve(m,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])]),_:1}),l(u,null,{default:a(()=>[l(v,{type:"primary",onClick:m},{default:a(()=>[i(" 查询 ")]),_:1}),l(v,{onClick:t[3]||(t[3]=e=>W(r(T)))},{default:a(()=>[i(" 重置 ")]),_:1})]),_:1}),l(v,{type:"success",style:{float:"right"},onClick:t[4]||(t[4]=e=>g.value=!0)},{default:a(()=>[i(" 创建应用 "),l(H,{class:"ml-3"},{default:a(()=>[l(G)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(y,{style:{width:"100%"}},{default:a(()=>[ie((_(),U(ee,{border:"",data:r(B),style:{width:"100%"},size:"large"},{default:a(()=>[l(d,{prop:"coverImg",label:"应用封面",width:"100"},{default:a(e=>[l(J,{style:{height:"50px"},src:e.row.coverImg,fit:"fill"},null,8,["src"])]),_:1}),l(d,{prop:"catName",label:"应用分类",width:"100"}),l(d,{prop:"name",label:"应用名称",width:"120"}),l(d,{prop:"order",label:"排序ID"}),l(d,{prop:"preset",label:"预设信息",width:"400"}),l(d,{prop:"status",label:"分类状态",width:"100"},{default:a(e=>[l(Z,{type:e.row.status===1?"success":"danger"},{default:a(()=>[i(S(r(we)[e.row.status]),1)]),_:2},1032,["type"])]),_:1}),l(d,{prop:"des",label:"描述信息",width:"300"}),l(d,{prop:"createdAt",label:"创建时间",width:"200"},{default:a(e=>[i(S(r(me)(new Date(e.row.createdAt),"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),l(d,{label:"操作",width:"200"},{default:a(e=>[l(v,{link:"",type:"primary",size:"small",onClick:se=>F(e.row)},{default:a(()=>[i(" 编辑 ")]),_:2},1032,["onClick"]),l(E,{title:"确认删除此应用么?",width:"200","icon-color":"red",onConfirm:se=>Q(e.row)},{reference:a(()=>[l(v,{link:"",type:"danger",size:"small"},{default:a(()=>[i(" 删除应用 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[ne,r(k)]]),l(te,{class:"flex justify-end mt-5"},{default:a(()=>[l(le,{"current-page":p.page,"onUpdate:currentPage":t[5]||(t[5]=e=>p.page=e),"page-size":p.size,"onUpdate:pageSize":t[6]||(t[6]=e=>p.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:r(N),onSizeChange:m,onCurrentChange:m},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),l(oe,{modelValue:r(g),"onUpdate:modelValue":t[16]||(t[16]=e=>fe(g)?g.value=e:null),"close-on-click-modal":!1,title:r(L),width:"570",onClose:t[17]||(t[17]=e=>K(r(D)))},{footer:a(()=>[ce("span",ye,[l(v,{onClick:t[14]||(t[14]=e=>g.value=!1)},{default:a(()=>[i("取消")]),_:1}),l(v,{type:"primary",onClick:t[15]||(t[15]=e=>X(r(D)))},{default:a(()=>[i(S(r(O)),1)]),_:1})])]),default:a(()=>[l(M,{ref_key:"formPackageRef",ref:D,"label-position":"right","label-width":"100px",model:n,rules:j},{default:a(()=>[l(u,{label:"App分类",prop:"catId"},{default:a(()=>[l(A,{modelValue:n.catId,"onUpdate:modelValue":t[7]||(t[7]=e=>n.catId=e),placeholder:"请选择App分类",clearable:"",style:{width:"100%"}},{default:a(()=>[(_(!0),C(z,null,q(r(h),e=>(_(),U(V,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"App名称",prop:"name"},{default:a(()=>[l(c,{modelValue:n.name,"onUpdate:modelValue":t[8]||(t[8]=e=>n.name=e),placeholder:"请填写App名称"},null,8,["modelValue"])]),_:1}),l(u,{label:"App状态",prop:"status"},{default:a(()=>[l(ae,{modelValue:n.status,"onUpdate:modelValue":t[9]||(t[9]=e=>n.status=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),l(u,{label:"App预设",prop:"preset"},{default:a(()=>[l(c,{modelValue:n.preset,"onUpdate:modelValue":t[10]||(t[10]=e=>n.preset=e),type:"textarea",placeholder:"请填写App介绍信息、用于对外展示...",rows:4},null,8,["modelValue"])]),_:1}),l(u,{label:"App描述",prop:"des"},{default:a(()=>[l(c,{modelValue:n.des,"onUpdate:modelValue":t[11]||(t[11]=e=>n.des=e),type:"textarea",placeholder:"请填写App介绍信息、用于场景内置信息...",rows:4},null,8,["modelValue"])]),_:1}),l(u,{label:"背景地址",prop:"coverImg"},{default:a(()=>[l(c,{modelValue:n.coverImg,"onUpdate:modelValue":t[12]||(t[12]=e=>n.coverImg=e),placeholder:"请填写封面图地址"},null,8,["modelValue"])]),_:1}),l(u,{label:"排序ID",prop:"order"},{default:a(()=>[l(c,{modelValue:n.order,"onUpdate:modelValue":t[13]||(t[13]=e=>n.order=e),modelModifiers:{number:!0},placeholder:"请填写排序ID[数字越大越靠前]"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});typeof $=="function"&&$(Ve);export{Ve as default};
